<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>UPI Payment — Ecommerit</title>
<style>
  :root {
    --bg: #f6f8fb;
    --card: #fff;
    --muted: #6b7280;
    --green: #16a34a;
  }
  body {
    font-family: system-ui, Segoe UI, Roboto, Arial, sans-serif;
    margin: 0;
    background: var(--bg);
    color: #111;
  }
  .wrap {
    max-width: 820px;
    margin: 28px auto;
    padding: 16px;
  }
  .card {
    background: var(--card);
    border-radius: 12px;
    padding: 18px;
    margin-bottom: 14px;
    box-shadow: 0 6px 18px rgba(20,20,50,.05);
  }
  h1 {
    margin: 0 0 6px;
    font-size: 22px;
  }
  p {
    margin: 6px 0 12px;
    color: var(--muted);
  }
  .grid {
    display: grid;
    gap: 12px;
  }
  @media(min-width:720px) {
    .grid {
      grid-template-columns: 1fr 1fr;
    }
  }
  .qr {
    width: 260px;
    height: 260px;
    border-radius: 10px;
    border: 8px solid #fff;
    display: block;
    box-shadow: 0 6px 18px rgba(0,0,0,.06);
  }
  label {
    display: block;
    font-size: 13px;
    margin-top: 8px;
    color: var(--muted);
  }
  input[type="number"], input[type="text"] {
    width: 100%;
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #e4e8f0;
    margin-top: 6px;
  }
  .btn {
    display: inline-block;
    padding: 10px 14px;
    border-radius: 8px;
    border: none;
    font-weight: 600;
    cursor: pointer;
  }
  .btn.primary {
    background: var(--green);
    color: #fff;
  }
  .btn.ghost {
    background: #f3f6fb;
    border: 1px solid #e6eef7;
    color: #0b1220;
  }
  .muted {
    color: var(--muted);
    font-size: 13px;
    margin-top: 8px;
  }
  .small {
    font-size: 12px;
    color: var(--muted);
  }
  .row {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    margin-top: 10px;
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>UPI Payment</h1>
      <p>Pay securely with any UPI app (GPay / PhonePe / Paytm). Update amount & note, then scan or open on mobile.</p>

      <div class="grid">
        <div>
          <h3 style="margin:0 0 10px">Scan to Pay</h3>
          <img id="qrImg" class="qr" src="" alt="UPI QR code">
          <div class="muted small">UPI ID: <strong id="upiIdText">ecommerit@airtel</strong></div>
          <div class="row">
            <button class="btn ghost" id="copyBtn">Copy UPI ID</button>
            <a id="downloadQr" class="btn ghost" href="#" download="upi-qr.png">Download QR</a>
          </div>
        </div>

        <div>
          <h3 style="margin:0 0 10px">Pay with UPI App</h3>

          <label for="upiId">UPI ID</label>
          <input id="upiId" type="text" value="ecommerit@airtel" autocomplete="off">

          <label for="payeeName">Payee name (optional)</label>
          <input id="payeeName" type="text" value="Ecommerit" autocomplete="off">

          <label for="amount">Amount (INR)</label>
          <input id="amount" type="number" min="1" step="1" placeholder="100" autocomplete="off">

          <label for="note">Note / Order ID</label>
          <input id="note" type="text" placeholder="Order #1234" autocomplete="off">

          <div class="row">
            <button class="btn primary" id="openBtn">Open in UPI App</button>
            <button class="btn ghost" id="updateBtn">Update Link & QR</button>
          </div>

          <div class="muted small" style="margin-top:12px">
            Deep link: <code id="upiLink" style="display:block;word-break:break-all">—</code>
          </div>
        </div>
      </div>
    </div>

    <div class="card small">
      <strong>How to test on mobile:</strong>
      <ol>
        <li>Host this file and open via mobile browser on the same Wi-Fi (e.g. <code>http://192.168.1.10/upi-payment.html</code>).</li>
        <li>Or upload it to any static host (GitHub Pages / Vercel / Netlify).</li>
        <li>Tap <em>Open in UPI App</em> on phone or scan the QR with a UPI app.</li>
      </ol>
    </div>
  </div>

  <script>
    const currency = 'INR';

    const upiIdInput = document.getElementById('upiId');
    const payeeInput = document.getElementById('payeeName');
    const amountInput = document.getElementById('amount');
    const noteInput = document.getElementById('note');
    const qrImg = document.getElementById('qrImg');
    const upiLinkEl = document.getElementById('upiLink');
    const upiIdText = document.getElementById('upiIdText');
    const copyBtn = document.getElementById('copyBtn');
    const updateBtn = document.getElementById('updateBtn');
    const openBtn = document.getElementById('openBtn');
    const downloadQr = document.getElementById('downloadQr');

    function buildUpiLink(upiId, payee, amt, note) {
      const parts = [];
      parts.push('pa=' + encodeURIComponent(upiId));
      if (payee) parts.push('pn=' + encodeURIComponent(payee));
      parts.push('cu=' + encodeURIComponent(currency));
      if (amt) parts.push('am=' + encodeURIComponent(amt));
      if (note) parts.push('tn=' + encodeURIComponent(note));
      return 'upi://pay?' + parts.join('&');
    }

    function updateAll() {
      const upiId = (upiIdInput.value || '').trim() || 'ecommerit@airtel';
      const payee = (payeeInput.value || '').trim() || 'Ecommerit';
      const amt = (amountInput.value || '').trim();
      const note = (noteInput.value || '').trim();

      const upiLink = buildUpiLink(upiId, payee, amt || null, note || null);
      upiLinkEl.textContent = upiLink;
      upiIdText.textContent = upiId;

      // Generate QR code from api.qrserver.com
      const qrUrl = 'https://api.qrserver.com/v1/create-qr-code/?size=260x260&data=' + encodeURIComponent(upiLink);
      qrImg.src = qrUrl;
      downloadQr.href = qrUrl;
      openBtn.onclick = function (e) {
        e.preventDefault();
        window.location.href = upiLink;
      };
    }

    copyBtn.addEventListener('click', () => {
      const text = (upiIdInput.value || '').trim() || 'ecommerit@airtel';
      navigator.clipboard.writeText(text).then(() => {
        copyBtn.textContent = 'Copied!';
        setTimeout(() => (copyBtn.textContent = 'Copy UPI ID'), 1400);
      });
    });

    // Update QR/link on inputs change
    [upiIdInput, payeeInput, amountInput, noteInput].forEach(el => {
      el.addEventListener('input', updateAll);
    });

    // Update QR/link on button click
    updateBtn.addEventListener('click', (e) => {
      e.preventDefault();
      updateAll();
    });

    // Initialize on page load
    updateAll();
  </script>
</body>
</html>
